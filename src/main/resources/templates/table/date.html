<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script th:src="@{webjars/jquery/1.12.4/jquery.js}" rel="stylesheet"></script>
    <link th:href="@{webjars/bootstrap/5.1.0/css/bootstrap.min.css}" rel="stylesheet"/>
    <script th:src="@{webjars/bootstrap/5.1.0/js/bootstrap.min.js}" rel="stylesheet"></script>
    <script>
        $(function (){
            to_page(1)
        })
        function to_page(pn) {
            $.ajax({
                url: "/date",
                // contentType:"application/json",     //用来处理ajax请求异常
                headers:{
                    accept:"application/json",
                    contentType:"application/json"
                },
                data: "pn="+pn,
                success: function (data) {
                    //页面显示table
                    table_msg(data)
                    //显示分页信息
                    page_msg(data)
                    //显示分页条
                    page_nav(data)
                }
            })
        }
        function table_msg(data) {
            $("table tbody").html("")
            $.each(data.list,function (index,item) {
                var Id = $("<td></td>").append(item.id);
                var Num = $("<td></td>").append(item.num);
                var PassWord = $("<td></td>").append(item.password);
                var editBtn = $("<button></button>").addClass("btn btn-primary btn-sm")
                    .append($("<span></span>").addClass("glyphicon glyphicon-wrench"))
                    .append("编辑");
                var delBtn = $("<button></button>").addClass("btn btn-danger btn-sm")
                    .append($("<span></span>").addClass("glyphicon glyphicon-remove"))
                    .append("删除");
                var curd = $("<td></td>").append(editBtn).append(delBtn);
                $("<tr></tr>").append(Id)
                    .append(Num)
                    .append(PassWord)
                    .append(curd)
                    .appendTo(".table-striped tbody")
            })
        }
        function page_msg(data) {
            $("#pageInfo_page").empty()
            $("#pageInfo_page").append("当前"
                +data.pageNum+"页,总"
                +data.pages+"页,总"
                +data.total+"条记录")
            totalRecord=data.total;
        }
        function page_nav(data) {
            $("#pageInfo_nav").empty()
            var ul = $("<ul></ul>").addClass("pagination");
            var firstPageLi = $("<li></li>").append($("<a></a>").append("首页").attr("href","#"));
            var prePageLi = $("<li></li>").append($("<a></a>").append($("<span></span>").append("&laquo;")));
            //如果没有前一页添加不可点击,并不给绑定事件
            if(!data.hasPreviousPage){
                prePageLi.addClass("disabled")
                firstPageLi.addClass("disabled")
            }else{
                //为元素添加翻页点击事件
                firstPageLi.click(function () {
                    to_page(1);
                })
                prePageLi.click(function () {
                    to_page(result.extend.pageInfo.pageNum -1);
                })
            }
            var nextPageLi = $("<li></li>").append($("<a></a>").append($("<span></span>").append("&raquo;")));
            var lastPageLi = $("<li></li>").append($("<a></a>").append("尾页").attr("href","#"));
            //如果没有下一页添加不可点击,并不给绑定事件
            if(!data.hasNextPage){
                nextPageLi.addClass("disabled")
                lastPageLi.addClass("disabled")
            }else{
                //为元素添加翻页点击事件
                lastPageLi.click(function () {
                    to_page(data.pages);
                })
                nextPageLi.click(function () {
                    to_page(data.pageNum +1);
                })
            }
            ul.append(firstPageLi).append(prePageLi);
            //1,2,3连续页码遍历,并给添加进ul
            $.each(data.navigatepageNums,function (index,item) {
                var pageNumsLi = $("<li></li>").append($("<a></a>").append(item).attr("href","#"));
                if (data.pageNum == item){
                    //增加高亮
                    pageNumsLi.addClass("active")
                }
                ul.append(pageNumsLi);
                //为每个页码添加点击事件,重新发出请求到controll中
                pageNumsLi.click(function (){
                    to_page(item)
                })
            })
            ul.append(nextPageLi).append(lastPageLi);
            var navEle = $("<nav></nav>").append(ul)
            navEle.appendTo("#pageInfo_nav")
        }
    </script>
</head>
<body>

<table class="table table-striped">
    <thead>
        <tr>
            <td>id</td>
            <td>num</td>
            <td>password</td>
            <td>CURD</td>
        </tr>
    </thead>
    <tbody>

    </tbody>
</table>
<!--显示分页信息-->
<div class="row">
    <!--分页文字信息-->
    <div class="col-lg-6" id="pageInfo_page">

    </div>
    <!--分页条信息-->
    <div class="col-lg-6" id="pageInfo_nav">

    </div>
</div>
</body>
</html>